<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<title> GAEでfaviconを設定 &middot; ふぉれすけ広場 </title>


<link rel="stylesheet" href="https://foresukecom.github.io/css/slim.css">
<link rel="stylesheet" href="https://foresukecom.github.io/css/highlight.min.css">
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Source+Code+Pro' rel='stylesheet' type='text/css'>

<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="/favicon.ico">


<link href="" rel="alternate" type="application/rss+xml" title="ふぉれすけ広場" />

</head>

<body>
  <div class="container">
    <div class="header">
  <h1 class="site-title"><a href="https://foresukecom.github.io/">ふぉれすけ広場</a></h1>
  <p class="site-tagline">筋トレしたり、お酒を飲んだり、壁を登ったり。</p>
  <div class="nav">
    <a class="nav-btn" href="#">
      <span class="ci ci-burger"></span>
    </a>
    <ul class="nav-list">
       
	  <li class="spacer">&ac;</li>

      <li><a href="https://github.com/foresukecom">Github</a></li> 
      <li><a href="https://twitter.com/foresukecom">Twitter</a></li> 
    </ul>
  </div>
</div>
    <div class="content">
      <div class="posts">
        <div class="post">
          <h2 class="post-title"><a href="https://foresukecom.github.io/post/gae_favicon/">GAEでfaviconを設定</a></h2>
          <span class="post-date">Nov 6, 2018 </span>
          <div class="post-content">
            <h2 id="はじめに">はじめに</h2>
<p>GoogleAppEngine(GAE)上で提供するWebページにfaviconを設定するさいに、少し迷ったのでメモに残しておきます。</p>
<h2 id="faviconとは">faviconとは</h2>
<p>faviconとは、ブラウザのタブやブックマークに表示されてるアレです。<br>
最近は、スマートフォンでWebページのショートカットをホーム画面や、Windows10のスタートメニューで見かけることも増えてきました。</p>
<p>faviconについては、以下の資料に詳しくまとめられています。<br>
<a href="https://speakerdeck.com/oscasierra/websaitoga-dekita-toan-xin-suruqian-nizui-zhong-tietukusurukoto?slide=5">WEBサイトが「できた」と安心する前に最終チェックすること</a></p>
<h2 id="favicon準備">favicon準備</h2>
<p>faviconの元にするイラストはこちらです。
このイラストをいい感じにfaviconとして使っていきます。
<!-- raw HTML omitted --></p>
<p>今回は、スライドで紹介されている<a href="https://realfavicongenerator.net/">Favicon Generator</a>を使ってfaviconを用意していきます。<br>
faviconを生成すると、<code>favicon_package_v0.16.zip</code>がダウンロードできます。<br>
<code>favicon_package_v0.16.zip</code>は以下のような中身になっています。</p>
<pre><code>favicon_package_v0.16
├── android-chrome-192x192.png
├── android-chrome-384x384.png
├── apple-touch-icon.png
├── browserconfig.xml
├── favicon-16x16.png
├── favicon-32x32.png
├── favicon.ico
├── mstile-150x150.png
├── safari-pinned-tab.svg
└── site.webmanifest
</code></pre><p>この中ので拡張子が<code>png</code>、<code>ico</code>は実際に表示されるイメージファイルです。<br>
<code>browserconfig.xml</code>はWindows10のスタート画面にWebページをピン留めしたときに表示される画像の設定情報です。このファイルは明示的に読み込まなくても、ルートディレクトリに置いておけば、勝手に読み込んでくれます。<br>
<code>safari-pinned-tab.svg</code>はベクターというフォーマットの画像ファイルです。safariで表示するfaviconはこの画像を使っているようです。<br>
<code>site.webmanifest</code>はAndroidでWebページをホーム画面に追加したときのアイコンや、タイトルを設定するファイルです。</p>
<p>今回は<a href="https://foresuke.com/post/google_app_engine_go_ajax/">GAE上でGolangを動かしてみましたよ</a>の構成を元に、faviconを設定します。<br>
<code>browserconfig.xml</code>と<code>site.webmanifest</code>はルートディレクトリに配置し、その他の画像ファイルはルートディレクトリ直下の<code>images</code>に配置します。<br>
プロジェクトのディレクトリ構成は以下の通りです。</p>
<pre><code>.
├── app.yaml
├── gae_sample.iml
├── hello.go
├── index.yaml
└── static
    ├── browserconfig.xml
    ├── site.webmanifest
    ├── images
    │   ├── android-chrome-192x192.png
    │   ├── android-chrome-384x384.png
    │   ├── apple-touch-icon.png
    │   ├── favicon-16x16.png
    │   ├── favicon-32x32.png
    │   ├── favicon.ico
    │   ├── mstile-150x150.png
    │   └── safari-pinned-tab.svg
    ├── index.html
    └── js
        └── main.js
</code></pre><h2 id="gaeで使う">GAEで使う</h2>
<p>GoogleAppEngineでfaviconを使用するには、HTMLファイルの<code>&lt;head&gt;</code>で読み込む以外に、<a href="https://cloud.google.com/appengine/kb/#erroruris">Why do I get URI error for /favicon.ico?</a>にも書かれているとおり、<code>app.yaml</code>にも記載する必要があります。</p>
<p>愚直に書く場合、<code>handlers:</code>の配下に以下の記載します。</p>
<pre><code>- url: /site.webmanifest
  static_files: static/site.webmanifest
  upload: static/site.webmanifest

- url: /browserconfig.xml
  static_files: static/browserconfig.xml
  upload: static/browserconfig.xml

- url: /images/favicon.ico
  static_files: static/images/favicon.ico
  upload: static/favicon.ico

- url: /images/favicon-32x32.png
  static_files: static/images/favicon-32x32.png
  upload: static/images/favicon-32x32.png

- url: /images/favicon-16x16.png
  static_files: static/images/favicon-16x16.png
  upload: static/images/favicon-16x16.png

- url: /images/android-chrome-192x192.png
  static_files: static/images/android-chrome-192x192.png
  upload: static/images/android-chrome-192x192.png

- url: /images/android-chrome-384x384.png
  static_files: static/images/android-chrome-384x384.png
  upload: static/images/android-chrome-384x384.png

- url: /images/mstile-150x150.png
  static_files: static/images/mstile-150x150.png
  upload: static/images/mstile-150x150.png

- url: /images/apple-touch-icon.png
  static_files: static/images/apple-touch-icon.png
  upload: static/images/apple-touch-icon.png

- url: /images/safari-pinned-tab.svg
  static_files: static/images/safari-pinned-tab.svg
  upload: static/images/safari-pinned-tab.svg
</code></pre><p>ファイル毎に書いていくのは面倒なので、以下のような感じで正規表現でまとめて記載することもできます。</p>
<pre><code>- url: /site.webmanifest
  static_files: static/site.webmanifest
  upload: static/site.webmanifest

- url: /browserconfig.xml
  static_files: static/browserconfig.xml
  upload: static/browserconfig.xml

- url: /images/(.*\.(svg|ico|png))
  static_files: static/images/\1
  upload: static/(.*\.(svg|ico|png))
</code></pre><p>これで、GAEのページにfaviconを設定することが出来ました。<br>
<a href="https://realfavicongenerator.net/">Favicon Generator</a>では、各プラットフォームからfaviconにアクセス出来ているかを一括でチェックできるのでとても便利です。<br>
今回は、<code>favicon.ico</code>がルートディレクトリにない、と怒られていますが各プラットフォームからfaviconが見れているいることが確認できました。
<!-- raw HTML omitted --></p>
<p>今回のサンプルファイルはgithubで公開してます。<br>
<a href="https://github.com/foresukecom/gae_favicon">https://github.com/foresukecom/gae_favicon</a></p>
<h2 id="その他">その他</h2>
<p>毎回なにかオススメを紹介してましたが、ネタが切れました。</p>

          </div>
        </div>
        <div class="pagination">
          <a class="btn previous " href="https://foresukecom.github.io/post/shukujitsu_info/"> Prev</a>  
          <a class="btn next " href="https://foresukecom.github.io/post/gae_cron/"> Next</a> 
        </div>
      </div>
    </div>
    
    <div class="footer">
  
  <p>Powered by <a href="https://gohugo.io">Hugo</a>. This theme—Slim—is open sourced on <a href="https://github.com/zhe/hugo-theme-slim">Github</a>.</p>
  
</div>

  </div>
  <script src="https://foresukecom.github.io/js/slim.js"></script>
  <script src="https://foresukecom.github.io/js/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
  <script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-89386946-1', 'auto');
ga('send', 'pageview');

</script>

</body>

</html>
