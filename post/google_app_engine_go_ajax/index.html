<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<title> GAE上でGolangを動かしてみましたよ &middot; ふぉれすけ広場 </title>


<link rel="stylesheet" href="http://foresukecom.github.iocss/slim.css">
<link rel="stylesheet" href="http://foresukecom.github.iocss/highlight.min.css">
<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Source+Code+Pro' rel='stylesheet' type='text/css'>

<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="/favicon.ico">


<link href="" rel="alternate" type="application/rss+xml" title="ふぉれすけ広場" />

</head>

<body>
  <div class="container">
    <div class="header">
  <h1 class="site-title"><a href="http://foresukecom.github.io">ふぉれすけ広場</a></h1>
  <p class="site-tagline">筋トレしたり、お酒を飲んだり、壁を登ったり。</p>
  <div class="nav">
    <a class="nav-btn" href="#">
      <span class="ci ci-burger"></span>
    </a>
    <ul class="nav-list">
       
	  <li class="spacer">&ac;</li>
  
    </ul>
  </div>
</div>
    <div class="content">
      <div class="posts">
        <div class="post">
          <h2 class="post-title"><a href="http://foresukecom.github.io/post/google_app_engine_go_ajax/">GAE上でGolangを動かしてみましたよ</a></h2>
          <span class="post-date">Aug 13, 2018 </span>
          <div class="post-content">
            <h2 id="はじめに">はじめに</h2>
<p>GoogleAppEngine上で動くwebサービスをgolangで作りはじめました。<br>
作り始めでつまずくことが多いので自分用の最小構成メモです。
ここで説明するwebサービスは、Ajaxで非同期通信し、Golangが返した文字列を表示するだけのものです。</p>
<h2 id="環境の準備">環境の準備</h2>
<p>まずは、<a href="https://cloud.google.com/appengine/docs/standard/go/download">GCPの公式ドキュメント</a>を参考にGolang、Cloud SDKをダウンロードします。<br>
以下のようにバージョンが表示されればOKです。</p>
<pre><code>$ goapp version
go version 1.9.4 (appengine-1.9.74) darwin/amd64
</code></pre><p>ちなみに、開発にはmacOS High Sierra(10.13.6)を使用しています。</p>
<h2 id="構成説明">構成説明</h2>
<p>ディレクトリ構成は以下の通りです。</p>
<pre><code>├── app.yaml
├── hello.go
└── static
    ├── js
    │   └── main.js
    ├── css
    │   └── main.css
    └── index.html
</code></pre><p>この中でGAE特有のファイルは<code>app.yaml</code>になります。<br>
<a href="https://cloud.google.com/appengine/docs/standard/go/config/appref">app.yamlリファレンス</a>に各パラメータの説明が載ってますが、最低限のパラメータだけ書いておきます。</p>
<pre><code>runtime: go #Golangを使用する場合はgoを指定
api_version: go1 #最新のバージョンを使用する場合はgo1を指定

handlers: #リクエストと実行する処理をURLパターン毎に指定
- url: /
  static_files: static/index.html
  upload: static/index.html
- url: /js
  static_dir: static/js
- url: /css
  static_dir: static/css
- url: /.*
  script: _go_app
</code></pre><p>その他のファイルについては、特別なことはしていないので説明は省略します。<br>
各ファイルは<a href="https://github.com/foresukecom/go-appengine-sample">Github</a>に置いてあります。</p>
<h2 id="ローカル環境での実行">ローカル環境での実行</h2>
<p>ローカル環境にGoogleAppEngineの開発用サーバを立ち上げるには、Cloud SDKに含まれている<code>dev_appserver.py</code>を実行します。<br>
実行時のオプションはいくつも用意されていますが、サーバを立ち上げるだけならば、以下のように<code>app.yaml</code>を指定して実行すれば問題ありません。
※<code>dev_appserver.py</code>を実行するにはPython2.xがインストールされている必要があります。</p>
<pre><code>dev_appserver.py app.yaml
</code></pre><p>サーバが立ち上がったら、ブラウザから<a href="http://localhost:8080">http://localhost:8080</a>にアクセスすれば、開発サーバ上のwebサービスにアクセスができます。</p>
<h2 id="本番へのデプロイ">本番へのデプロイ</h2>
<p>GoogleAppEngine上にデプロイする場合は、以下のコマンドを実施します。</p>
<pre><code>gcloud app deploy app.yaml
</code></pre><h2 id="まとめ">まとめ</h2>
<p>今回、GoogleAppEngine上で動かすことを目的としているので、最低限のオプションしか指定していません。
実際に使用する場合は、セキュリティを高めたり、パフォーマンスの最適化を図ってください。<br>
記事の内容に不備や誤りがありましたら、<a href="https://twitter.com/foresukecom">@foresukecom</a>までご連絡ください。</p>
<h2 id="その他">その他</h2>
<p>最近、Life is Strageというゲームをクリアしました。<br>
後半は感情移入して涙目になりながら遊んでしまいました、ゲームで泣いたのは幻想水滸伝2以来です。</p>
<!-- raw HTML omitted -->
<p>ゲーム自体は短めで、週末だけでクリアできる程度のボリュームなので、是非遊んでみてください。
PS4とSteamで遊ぶことができます(Steamは年に数回75%OFFのセールを実施するので、そこで買っておくのがおすすめです)。</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>このゲームはストーリーもよいのですが、要所要所で流れるBGMが特に素晴らしいです。<br>
サントラはAmazonPrimeMusicの対象にもなっているので、Amazonプライム会員の方は是非聴いてみて下さい。落ち着いた音楽で、作業用BGMとしても最適です。</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->

          </div>
        </div>
        <div class="pagination">
          <a class="btn previous " href="http://foresukecom.github.io/post/english_comic/"> Prev</a>  
          <a class="btn next " href="http://foresukecom.github.io/post/vue_array/"> Next</a> 
        </div>
      </div>
    </div>
    
    <div class="footer">
  
  <p>Powered by <a href="https://gohugo.io">Hugo</a>. This theme—Slim—is open sourced on <a href="https://github.com/zhe/hugo-theme-slim">Github</a>.</p>
  
</div>

  </div>
  <script src="http://foresukecom.github.iojs/slim.js"></script>
  <script src="http://foresukecom.github.iojs/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
  
</body>

</html>
